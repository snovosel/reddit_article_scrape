<!DOCTYPE html>

<head>
  <title> Favorites </title>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

  <script type=text/javascript>

  $(document).ready(function() {

        // send ajax
          $.ajax({
              url: '/favorites', // url where to submit the request
              type : "GET", // type of action POST || GET
              dataType : 'json', // data type
              success : function(data) {
                populate_list(data);
                  // you can see the result from the console
                  // tab of the developer tools

              },
              error: function(xhr, resp, text) {
                  console.log(xhr, resp, text);
              }
          });




    function populate_list(data) {
      $.each(data, function(i, item) {

        var $ul = $("<ul> ").append(
                $('<li>').html("<button class='delete_favorite' id=" + item.id + "> Delete Favorite </button>"),
                $('<li>').html("<a href=" + item.url + ">" + item.title + "</a>"),
                $('<li>').html(item.score)
        ).appendTo('#container');

      });



      $(".delete_favorite").click(function() {
        var post = $(this).attr('id');
        console.log(post);
          // send ajax
          $.ajax({
              url: '/favorites/', // url where to submit the request
              type : 'DELETE', // type of action POST || GET
              dataType : 'json', // data type
              contentType: "application/json",
              data: JSON.stringify({
                              'favorite': post
                               }), // post data || get data
              success : function(result) {
                  // you can see the result from the console
                  // tab of the developer tools


                  //console.log(post);

              },
              error: function(xhr, resp, text) {
                  console.log(xhr, resp, text);
              }
          });

          $(this).parent().closest('ul').remove();

          return false;

      });




    };


  });

  </script>

</head>

<body>

<div id="container">


</div>

<a href="/subchoice"> Back </a>

</body>

</html>
